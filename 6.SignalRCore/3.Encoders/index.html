<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="Tivadar GyÃ¶rgy Nagy">
    <link rel="canonical" href="http://u3d.as/5sb/6.SignalRCore/3.Encoders/">
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Encoders - Best HTTP/2 Documentation</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
	<link rel="stylesheet" href="../../css/prism.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
	<script src="../../js/prism.js"></script>
	
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Encoders", url: "#_top", children: [
              {title: "JSon", url: "#json" },
              {title: "How to Enable and Use Newtonsoft's JSON .NET For Unity Encoder", url: "#how-to-enable-and-use-newtonsofts-json-net-for-unity-encoder" },
              {title: "MessagePack", url: "#messagepack" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script> 
</head>

<body class="line-numbers match-braces" >
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../4.IRetryPolicy/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../4.IRetryPolicy/" class="btn btn-xs btn-link">
        Automatic reconnection and the IRetryPolicy interface
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../2.Authentication/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../2.Authentication/" class="btn btn-xs btn-link">
        The IAuthenticationProvider interface
      </a>
    </div>
    
  </div>

    

    <h1 id="encoders">Encoders</h1>
<p>SignalR Core can use different encodings to send and receive messages. Current encodings are JSon and MessagePack.
Using these are not automatic, as most of these implementations require 3rd plugins and/or changes to the server.</p>
<div class="admonition warning">
<p class="admonition-title">Advice:</p>
<p>If possible use MessagePack as it's more efficient memory and cpu wise too!</p>
</div>
<h2 id="json">JSon</h2>
<p>For the plugin, the JSon encoder is available without any additional steps. The <code>JsonProtocol</code> class is a generic implementation that can work with different encoders that can use concreate JSON parsers. The one that comes with the plugin is the <code>LitJsonEncoder</code>.</p>
<pre><code class="language-csharp">hub = new HubConnection(new Uri(&quot;https://server/hub&quot;), new JsonProtocol(new LitJsonEncoder()));
</code></pre>

<h2 id="how-to-enable-and-use-newtonsofts-json-net-for-unity-encoder">How to Enable and Use Newtonsoft's JSON .NET For Unity Encoder</h2>
<p>There's an encoder implementation that uses the <a href="https://assetstore.unity.com/packages/tools/input-management/json-net-for-unity-11347?aid=1101lfX8E">Newtonsoft's JSON .NET For Unity</a> package.</p>
<p>Steps to enable it and use it:</p>
<ol>
<li>Download and import the <a href="https://assetstore.unity.com/packages/tools/input-management/json-net-for-unity-11347?aid=1101lfX8E">Newtonsoft's JSON .NET For Unity</a> package</li>
<li>
<p>Add the <strong>BESTHTTP_SIGNALR_CORE_ENABLE_NEWTONSOFT_JSON_DOTNET_ENCODER</strong> define to the <a href="https://docs.unity3d.com/Manual/PlatformDependentCompilation.html">Scripting Define Symbols</a> input under <strong>PlayerSettings/Other Settings</strong>:</p>
<p><img alt="Scrypting Define Symbols" src="../media/JSONDotNet_ScriptingDefineSymbols.png" /></p>
</li>
<li>
<p>Use the now-available <code>JsonDotNetEncoder</code> class:</p>
</li>
</ol>
<pre><code class="language-csharp">hub = new HubConnection(new Uri(&quot;https://server/hub&quot;), new JsonProtocol(new JsonDotNetEncoder()));
</code></pre>

<p>The <code>JsonDotNetEncoder</code> and the <code>LitJsonEncoder</code> classes can be found in the <code>Best HTTP\Examples\SignalRCore\Encoders\</code> folder.</p>
<h2 id="messagepack">MessagePack</h2>
<p>By default the server has support for the JSon encoding but by <a href="https://docs.microsoft.com/en-us/aspnet/core/signalr/messagepackhubprotocol?view=aspnetcore-3.1">adding new packages and a few lines of code</a> the MessagePack encoding can be enabled too.</p>
<p>There's a MessagePack encoding implementation for the plugin, but it's disabled by default. To enable and use it, follow these steps:</p>
<ol>
<li>Download and import the <a href="https://assetstore.unity.com/packages/tools/network/json-messagepack-serialization-59918?aid=1101lfX8E">Json &amp; MessagePack Serialization</a> package</li>
<li>Create a new <a href="https://docs.unity3d.com/Manual/ScriptCompilationAssemblyDefinitionFiles.html">Asembly Definition file</a> under the <em>Plugins\GameDevWare.Serialization</em> folder</li>
<li>Locate the BestHTTP.asmdef file under the <em>Best HTTP</em> folder</li>
<li>
<p>Reference the newly create asmdef file and press Apply:</p>
<p><img alt="BestHTTP_AssemblyDefinition_MessagePack" src="../media/BestHTTP_AssemblyDefinition_MessagePack.png" /></p>
</li>
<li>
<p>Add the <strong>BESTHTTP_SIGNALR_CORE_ENABLE_GAMEDEVWARE_MESSAGEPACK</strong> define to the <a href="https://docs.unity3d.com/Manual/PlatformDependentCompilation.html">Scripting Define Symbols</a> input under <strong>PlayerSettings/Other Settings</strong>:</p>
<p><img alt="GameDevWare_MessagePack_ScriptingDefineSymbols.png" src="../media/GameDevWare_MessagePack_ScriptingDefineSymbols.png" /></p>
</li>
<li>
<p>Use the now available <code>MessagePackProtocol</code> class:</p>
</li>
</ol>
<pre><code class="language-csharp">hub = new HubConnection(new Uri(&quot;https://server/hub&quot;), new MessagePackProtocol());
</code></pre>

<p>As you can see, the <code>MessagePackProtocol</code> uses only one class there's no MessagePackEncoder as it's very specific and uses directly the <em>Json &amp; MessagePack Serialization</em> classes.</p>
<p>The <code>MessagePackProtocol</code> class can be found in the <code>Best HTTP\Examples\SignalRCore\Encoders\</code> folder.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../4.IRetryPolicy/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../4.IRetryPolicy/" class="btn btn-xs btn-link">
        Automatic reconnection and the IRetryPolicy interface
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../2.Authentication/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../2.Authentication/" class="btn btn-xs btn-link">
        The IAuthenticationProvider interface
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>