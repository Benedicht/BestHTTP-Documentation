<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="Tivadar György Nagy">
    <link rel="canonical" href="http://u3d.as/5sb/1.HTTP/AdvancedTopics/SmallCode-Samples/">
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Small Code-Samples - Best HTTP/2 Documentation</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
	<link rel="stylesheet" href="../../../css/prism.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
	<script src="../../../js/prism.js"></script>
	
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Small Code-Samples", url: "#_top", children: [
              {title: "Upload a picture using forms", url: "#upload-a-picture-using-forms" },
              {title: "Upload a picture without forms, sending only the raw data", url: "#upload-a-picture-without-forms-sending-only-the-raw-data" },
              {title: "Send json data", url: "#send-json-data" },
              {title: "Display download progress", url: "#display-download-progress" },
              {title: "Abort a request", url: "#abort-a-request" },
              {title: "Verify hostnames in HTTPS", url: "#verify-hostnames-in-https" },
              {title: "Get header values", url: "#get-header-values" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script> 
</head>

<body class="line-numbers match-braces" >
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Timeouts/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Timeouts/" class="btn btn-xs btn-link">
        Timeouts
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../ServerCertificateValidation/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../ServerCertificateValidation/" class="btn btn-xs btn-link">
        Server Certificate Validation
      </a>
    </div>
    
  </div>

    

    <h1 id="small-code-samples">Small Code-Samples</h1>
<h2 id="upload-a-picture-using-forms">Upload a picture using forms</h2>
<pre><code class="language-csharp">var request = new HTTPRequest(new Uri(&quot;http://server.com&quot;), HTTPMethods.Post, onFinished);

request.AddBinaryData(&quot;image&quot;, texture.EncodeToPNG(), &quot;image.png&quot;, &quot;image/png&quot;);

request.Send();
</code></pre>

<h2 id="upload-a-picture-without-forms-sending-only-the-raw-data">Upload a picture without forms, sending only the raw data</h2>
<pre><code class="language-csharp">var request = new HTTPRequest(new Uri(&quot;http://server.com&quot;), HTTPMethods.Post, onFinished);

request.SetHeader(&quot;Content-Type&quot;, &quot;image/png&quot;);
request.RawData = texture.EncodeToPNG();

request.Send();
</code></pre>

<h2 id="send-json-data">Send json data</h2>
<pre><code class="language-csharp">string json = &quot;{ 'field': 'value' }&quot;;

var request = new HTTPRequest(new Uri(&quot;http://server.com&quot;), HTTPMethods.Post, onFinished);

request.SetHeader(&quot;Content-Type&quot;, &quot;application/json; charset=UTF-8&quot;);
request.RawData = System.Text.Encoding.UTF8.GetBytes(json);

request.Send();
</code></pre>

<h2 id="display-download-progress">Display download progress</h2>
<pre><code class="language-csharp">var request = new HTTPRequest(new Uri(&quot;http://serveroflargefile.net/path&quot;), (req, resp) =&gt; {
  Debug.Log(&quot;Finished!&quot;);
});

request.OnDownloadProgress += (req, down, length) =&gt; Debug.Log(string.Format(&quot;Progress: {0:P2}&quot;, down / (float)length));

request.Send();
</code></pre>

<h2 id="abort-a-request">Abort a request</h2>
<pre><code class="language-csharp">var request = new HTTPRequest(new Uri(address), (req, resp) =&gt; {
    // State should be HTTPRequestStates.Aborted if we call Abort() before
    // it’s finishes
    Debug.Log(req.State);
});

request.Send();

// and then call Abort when the request isn't relevant anymore
request.Abort();
</code></pre>

<h2 id="verify-hostnames-in-https">Verify hostnames in HTTPS</h2>
<pre><code class="language-csharp">public sealed class HostNameVerifier : Org.BouncyCastle.Crypto.Tls.ICertificateVerifyer
{
    public bool IsValid(Uri targetUri, SecureProtocol.Org.BouncyCastle.Asn1.X509.X509CertificateStructure[] certs)
    {
        foreach (var cert in certs)
        {
            var values = cert.Subject.GetValueList();
            if (values.Contains(targetUri.Host))
                return true;
        }

        return false;
    }
}

HTTPManager.DefaultCertificateVerifyer = new HostNameVerifier();
</code></pre>

<h2 id="get-header-values">Get header values</h2>
<pre><code class="language-csharp">var request = new HTTPRequest(new Uri(&quot;https://httpbin.org/get&quot;), (req, resp) =&gt;
{
    // One response can contain multiple header: value pairs for the same 'header'.
    List&lt;string&gt; values = resp.GetHeaderValues(&quot;custom-header&quot;);
    foreach (string header in values)
        Debug.Log(header);

    // GetFirstHeaderValue returns the first header's value. It's good for headers that we are sure that occur only one per response.
    string contentLengthHeader = resp.GetFirstHeaderValue(&quot;content-length&quot;);
    Debug.Log(contentLengthHeader);
});

request.Send();
</code></pre>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Timeouts/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Timeouts/" class="btn btn-xs btn-link">
        Timeouts
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../ServerCertificateValidation/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../ServerCertificateValidation/" class="btn btn-xs btn-link">
        Server Certificate Validation
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>